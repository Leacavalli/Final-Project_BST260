<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Appendix</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Introduction.html">Introduction</a>
</li>
<li>
  <a href="Results_Web_scraping_and_Data_wrangling.html">Results: Web scraping and Data wrangling</a>
</li>
<li>
  <a href="Results_Data_analysis.html">Results: Data analysis</a>
</li>
<li>
  <a href="Conclusion.html">Conclusion</a>
</li>
<li>
  <a href="References.html">References</a>
</li>
<li>
  <a href="Appendix.html">Appendix</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Appendix</h1>

</div>


<pre class="r"><code>library(rvest)
library(readr)
library(tidyverse)
library(caret)
library(FNN)
library(wesanderson)
library(knitr)
library(kableExtra)
library(owidR)
library(RCurl)</code></pre>
<div id="web-scraping" class="section level2">
<h2>Web scraping</h2>
</div>
<div id="load-covid-mortality" class="section level1">
<h1>Load Covid mortality</h1>
<pre class="r"><code>html_covid_rates &lt;- read_html(&quot;https://www.statista.com/statistics/1104709/coronavirus-deaths-worldwide-per-million-inhabitants/&quot;)
tab_covid_rates_raw &lt;- (html_covid_rates |&gt; html_nodes(&quot;table&quot;))[[1]] |&gt; html_table()
df_covid_rates &lt;- tab_covid_rates_raw |&gt;
  mutate(Total_cases= as.numeric(gsub(&quot;,&quot;, &quot;&quot;, `Confirmed cases (absolute)`)),
         Total_deaths=as.numeric(gsub(&quot;,&quot;, &quot;&quot;, `Confirmed deaths (absolute)`)), 
         Pop_millions= as.numeric(gsub(&quot;,&quot;, &quot;&quot;, `Population (in millions)`)), 
         Country=Characteristic) |&gt;
  select(Country, Total_cases, Total_deaths, Pop_millions)

df_covid_rates</code></pre>
<pre><code>## # A tibble: 154 × 4
##    Country                Total_cases Total_deaths Pop_millions
##    &lt;chr&gt;                        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
##  1 Peru                       3691213       213714        33.0 
##  2 Bulgaria                   1180636        37279         6.93
##  3 Bosnia and Herzegovina      379982        15810         3.28
##  4 Hungary                    1932788        46661         9.75
##  5 Georgia                    1662299        16844         3.71
##  6 North Macedonia             316729         9337         2.07
##  7 Moldova                     521182        11570         2.62
##  8 Croatia                    1160253        16124         4.05
##  9 Czechia                    3943792        40334        10.7 
## 10 Slovakia                   2559088        20163         5.46
## # … with 144 more rows</code></pre>
</div>
<div id="load-vaccination-counts" class="section level1">
<h1>Load vaccination counts</h1>
<pre class="r"><code>url &lt;- getURL(&quot;https://covid.ourworldindata.org/data/owid-covid-data.csv&quot;)
tab_vax_rates_raw &lt;- read.csv(text = url)
df_vax_rates &lt;- tab_vax_rates_raw |&gt;
  select(location, date, people_fully_vaccinated, continent) |&gt;
  filter(!is.na(people_fully_vaccinated)) |&gt;
  group_by(location, continent) |&gt;
  summarise(fully_vax_count= max(people_fully_vaccinated)) |&gt;
  rename(Country =location, Continent=continent) 

df_vax_rates</code></pre>
<pre><code>## # A tibble: 235 × 3
## # Groups:   Country [235]
##    Country             Continent       fully_vax_count
##    &lt;chr&gt;               &lt;chr&gt;                     &lt;dbl&gt;
##  1 Afghanistan         &quot;Asia&quot;                 10615628
##  2 Africa              &quot;&quot;                    373098255
##  3 Albania             &quot;Europe&quot;                1269112
##  4 Algeria             &quot;Africa&quot;                6481186
##  5 Andorra             &quot;Europe&quot;                  53485
##  6 Angola              &quot;Africa&quot;                8193976
##  7 Anguilla            &quot;North America&quot;           10373
##  8 Antigua and Barbuda &quot;North America&quot;           62384
##  9 Argentina           &quot;South America&quot;        37889928
## 10 Armenia             &quot;Asia&quot;                   985807
## # … with 225 more rows</code></pre>
</div>
<div id="load-proportion-of-the-population-above-65"
class="section level1">
<h1>Load proportion of the population above 65</h1>
<pre class="r"><code>html_above_65 &lt;- read_html(&quot;https://en.wikipedia.org/wiki/List_of_countries_by_age_structure&quot;)
tab_above_65_raw &lt;- html_table(html_node(html_above_65, &quot;.wikitable&quot;), fill = T)
colnames(tab_above_65_raw) &lt;- tab_above_65_raw[1, ] 

df_above_65&lt;- tab_above_65_raw[-c(1,2),] |&gt;
  select(Country, `Over 65`) |&gt;
  rename(Percent_Over_65 =`Over 65`) |&gt;
  mutate(Percent_Over_65= parse_number(Percent_Over_65))


df_above_65</code></pre>
<pre><code>## # A tibble: 190 × 2
##    Country             Percent_Over_65
##    &lt;chr&gt;                         &lt;dbl&gt;
##  1 Albania                       13.0 
##  2 Algeria                        6.17
##  3 Angola                         2.3 
##  4 Antigua and Barbuda            8.91
##  5 Argentina                     12.1 
##  6 Armenia                       12.6 
##  7 Aruba (Netherlands)           15.0 
##  8 Australia                     15.9 
##  9 Austria                       19.9 
## 10 Azerbaijan                     7.29
## # … with 180 more rows</code></pre>
</div>
<div id="load-population-density" class="section level1">
<h1>Load Population density</h1>
<pre class="r"><code>html_pop_density &lt;- read_html(&quot;https://en.wikipedia.org/wiki/List_of_countries_and_dependencies_by_population_density&quot;)
tab_pop_density_raw &lt;- html_table(html_node(html_pop_density, &quot;.wikitable&quot;), fill = T)
colnames(tab_pop_density_raw) &lt;- tab_pop_density_raw[1, ]

df_pop_density &lt;- tab_pop_density_raw[-1,] |&gt;
  select(`Country, territory or dependency`, `/km2`) |&gt;
  rename(Country =`Country, territory or dependency`, km2 = `/km2`) |&gt;
  mutate(km2= as.numeric(gsub(&quot;,&quot;, &quot;&quot;, km2)))

df_pop_density</code></pre>
<pre><code>## # A tibble: 250 × 2
##    Country                      km2
##    &lt;chr&gt;                      &lt;dbl&gt;
##  1 Macau                      20806
##  2 Monaco                     18343
##  3 Singapore                   7617
##  4 Hong Kong                   6789
##  5 Gibraltar (BOT)             5445
##  6 Bahrain                     1864
##  7 Maldives                    1738
##  8 Malta                       1667
##  9 Sint Maarten (Netherlands)  1295
## 10 Bermuda (BOT)               1211
## # … with 240 more rows</code></pre>
</div>
<div id="load-gdp-per-capita" class="section level1">
<h1>Load GDP per capita</h1>
<pre class="r"><code>html_GDP_per_capita &lt;- read_html(&quot;https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)_per_capita&quot;)
tab_GDP_per_capita_raw &lt;- html_table(html_node(html_GDP_per_capita, &quot;.wikitable&quot;), fill = T)
colnames(tab_GDP_per_capita_raw) &lt;- tab_GDP_per_capita_raw[1, ]

df_GDP_per_capita &lt;- (tab_GDP_per_capita_raw[-1,] |&gt;
  select(`Country/Territory`, 5) |&gt;
  rename(Country=`Country/Territory`, GDP_per_capita = Estimate)|&gt;
  mutate(GDP_per_capita= as.numeric(gsub(&quot;,&quot;, &quot;&quot;, GDP_per_capita)),
         Country= str_trim(gsub(&quot;\\*&quot;, &quot;&quot;, Country) ) ))[-1,]

df_GDP_per_capita</code></pre>
<pre><code>## # A tibble: 223 × 2
##    Country        GDP_per_capita
##    &lt;chr&gt;                   &lt;dbl&gt;
##  1 Liechtenstein          169049
##  2 Monaco                 173688
##  3 Luxembourg             135683
##  4 Bermuda                110870
##  5 Ireland                 99152
##  6 Norway                  89203
##  7 Switzerland             93457
##  8 Isle of Man             86482
##  9 Cayman Islands          85347
## 10 Qatar                   61276
## # … with 213 more rows</code></pre>
</div>
<div id="load-obesity-rates" class="section level1">
<h1>Load obesity rates</h1>
<pre class="r"><code>html_obesity_rates &lt;- read_html(&quot;https://en.wikipedia.org/wiki/List_of_sovereign_states_by_obesity_rate&quot;)
tab_obesity_rates_raw &lt;- html_table(html_node(html_obesity_rates, &quot;.wikitable&quot;), fill = T)

df_obesity_rates &lt;- tab_obesity_rates_raw |&gt;
  rename(Obesity_rate=`Obesity rate (%)`)

df_obesity_rates</code></pre>
<pre><code>## # A tibble: 191 × 2
##    Country                        Obesity_rate
##    &lt;chr&gt;                                 &lt;dbl&gt;
##  1 United States                          36.2
##  2 Cook Islands                           55.9
##  3 Palau                                  55.3
##  4 Marshall Islands                       52.9
##  5 Tuvalu                                 51.6
##  6 Niue                                   50  
##  7 Tonga                                  48.2
##  8 Samoa                                  47.3
##  9 Kiribati                               46  
## 10 Federated States of Micronesia         45.8
## # … with 181 more rows</code></pre>
</div>
<div id="load-cardiovascular-disease-rate" class="section level1">
<h1>Load cardiovascular disease rate</h1>
<pre class="r"><code>tab_CVD_rate_raw &lt;- owid(&quot;cardiovascular-disease-death-rates&quot;)
df_CVD_rate &lt;- tab_CVD_rate_raw |&gt;
  rename(Country =entity, cvd_death_rate=&quot;Deaths - Cardiovascular diseases - Sex: Both - Age: Age-standardized (Rate)&quot;) |&gt;
  group_by(Country) |&gt;
  filter(year==max(year), !is.na(cvd_death_rate)) |&gt;
  select(Country, cvd_death_rate) 

df_CVD_rate</code></pre>
<pre><code>## # A tibble: 228 × 2
## # Groups:   Country [228]
##    Country              cvd_death_rate
##    &lt;chr&gt;                         &lt;dbl&gt;
##  1 Afghanistan                    583.
##  2 African Region (WHO)           277.
##  3 Albania                        314.
##  4 Algeria                        397.
##  5 American Samoa                 295.
##  6 Andorra                        106.
##  7 Angola                         305.
##  8 Antigua and Barbuda            227.
##  9 Argentina                      184.
## 10 Armenia                        345.
## # … with 218 more rows</code></pre>
</div>
<div id="format-country-names" class="section level1">
<h1>format country names</h1>
<pre class="r"><code># df_covid_rates
df_covid_rates$Country &lt;- str_replace_all(df_covid_rates$Country, &quot;\\p{No}&quot;, &quot;&quot;)
df_covid_rates$Country &lt;- gsub(&#39;USA&#39;, &#39;United States&#39;, df_covid_rates$Country)
df_covid_rates$Country &lt;- gsub(&#39;France&#39;, &#39;France&#39;, df_covid_rates$Country)
df_covid_rates$Country &lt;- gsub(&#39;United Kingdom&#39;, &#39;United Kingdom&#39;, df_covid_rates$Country)
df_covid_rates$Country &lt;- gsub(&#39;Netherlands&#39;, &#39;Netherlands&#39;, df_covid_rates$Country)
df_covid_rates$Country &lt;- gsub(&#39;Timor-Leste&#39;, &#39;Timor&#39;, df_covid_rates$Country)
df_covid_rates$Country &lt;- gsub(&quot;Congo \\(Kinshasa)&quot;, &quot;Democratic Republic of Congo&quot;, df_covid_rates$Country)
df_covid_rates$Country &lt;- gsub(&#39;Congo \\(Brazzaville)&#39;, &#39;Congo&#39;, df_covid_rates$Country)
df_covid_rates$Country &lt;- gsub(&quot;Czechia&quot;, &quot;Czech Republic&quot;, df_covid_rates$Country)

# df_vax_rates
df_vax_rates$Country &lt;- gsub(&quot;Czechia&quot;, &quot;Czech Republic&quot;, df_vax_rates$Country)

# df_above_65
df_above_65$Country &lt;- gsub(&#39;Democratic Republic of the Congo&#39;  , &#39;Democratic Republic of Congo&#39;, df_above_65$Country)
df_above_65$Country &lt;- gsub(&#39;Republic of the Congo&#39;  , &#39;Congo&#39;, df_above_65$Country)
df_above_65$Country &lt;- gsub(&quot;Timor-Leste&quot;  , &quot;Timor&quot;, df_above_65$Country)
df_above_65$Country &lt;- gsub(&quot;Ivory Coast&quot;  , &quot;Cote d&#39;Ivoire&quot;, df_above_65$Country)
df_above_65$Country &lt;- gsub(&quot;Eswatini \\(Swaziland)&quot;  , &quot;Eswatini&quot;, df_above_65$Country)

# df_pop_density
df_pop_density$Country &lt;- gsub(&#39;DR Congo&#39;  , &#39;Democratic Republic of Congo&#39;, df_pop_density$Country)
df_pop_density$Country &lt;- gsub(&#39;Cyprus \\[note 5]&#39;  , &#39;Cyprus&#39;, df_pop_density$Country)
df_pop_density$Country &lt;- gsub(&#39;Russia \\[note 12]&#39;  , &#39;Russia&#39;, df_pop_density$Country)
df_pop_density$Country &lt;- gsub(&#39;Ukraine \\[note 9]&#39;  , &#39;Ukraine&#39;, df_pop_density$Country)
df_pop_density$Country &lt;- gsub(&#39;Ivory Coast&#39;  , &quot;Cote d&#39;Ivoire&quot;, df_pop_density$Country)
df_pop_density$Country &lt;- gsub(&#39;East Timor&#39;  , &#39;Timor&#39;, df_pop_density$Country)

# GDP per capita
df_GDP_per_capita$Country &lt;- gsub(&#39;East Timor&#39;  , &#39;Timor&#39;, df_GDP_per_capita$Country)
df_GDP_per_capita$Country &lt;- gsub(&#39;DR Congo&#39;  , &#39;Democratic Republic of Congo&#39;, df_GDP_per_capita$Country)
df_GDP_per_capita$Country &lt;- gsub(&#39;Ivory Coast&#39;  , &quot;Cote d&#39;Ivoire&quot;, df_GDP_per_capita$Country)


# obesity rates
df_obesity_rates$Country &lt;- gsub(&#39;Timor-Leste&#39;  , &#39;Timor&#39;, df_obesity_rates$Country)
df_obesity_rates$Country &lt;- gsub(&#39;Democratic Republic of the Congo&#39;  , &#39;Democratic Republic of Congo&#39;, df_obesity_rates$Country)
df_obesity_rates$Country &lt;- gsub(&#39;Republic of the Congo&#39;  , &#39;Congo&#39;, df_obesity_rates$Country)
df_obesity_rates$Country &lt;- gsub(&quot;Ivory Coast&quot;  , &quot;Cote d&#39;Ivoire&quot;, df_obesity_rates$Country)

# df_CVD_rate
df_CVD_rate$Country &lt;- gsub(&quot;Czechia&quot;, &quot;Czech Republic&quot;, df_CVD_rate$Country)</code></pre>
</div>
<div id="data-wrangling-join-tables" class="section level1">
<h1>data wrangling: join tables</h1>
<pre class="r"><code># join and transform data to create the analysis-ready dataframe 
analysis_df &lt;- left_join(df_covid_rates, df_vax_rates) |&gt;
  left_join(df_above_65)|&gt;
  left_join(df_pop_density)|&gt;
  left_join(df_GDP_per_capita)|&gt;
  left_join(df_obesity_rates)|&gt;
  left_join(df_CVD_rate)

analysis_df[which(is.na(analysis_df$Continent)),]$Continent &lt;- c(&quot;Asia&quot;,&quot;Africa&quot;)

# write.csv(analysis_df, &quot;analysis_df.csv&quot;)

analysis_df</code></pre>
<pre><code>## # A tibble: 154 × 11
##    Country                Total_cases Total_deaths Pop_millions Continent     fully_vax_count Percent_Over_65   km2 GDP_per_capita Obesi…¹ cvd_d…²
##    &lt;chr&gt;                        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;                   &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Peru                       3691213       213714        33.0  South America        28382375            8.05    26           6692    19.7    88.6
##  2 Bulgaria                   1180636        37279         6.93 Europe                2074576           20.1     62          11635    25     541. 
##  3 Bosnia and Herzegovina      379982        15810         3.28 Europe                 846080           16.2     64           6916    17.9   344. 
##  4 Hungary                    1932788        46661         9.75 Europe                6206878           20.7    104          18773    26.4   302. 
##  5 Georgia                    1662299        16844         3.71 Asia                  1276173           16.8     53           5042    21.7   454  
##  6 North Macedonia             316729         9337         2.07 Europe                 838032           14.2     82           6721    22.4   569. 
##  7 Moldova                     521182        11570         2.62 Europe                1073162           14.0     90           5315    18.9   405. 
##  8 Croatia                    1160253        16124         4.05 Europe                2250364           21.1     72          17399    24.4   266. 
##  9 Czech Republic             3943792        40334        10.7  Europe                6891491           20.2    133          26379    26     232. 
## 10 Slovakia                   2559088        20163         5.46 Europe                2577827           17.0    111          21088    20.5   299. 
## # … with 144 more rows, and abbreviated variable names ¹​Obesity_rate, ²​cvd_death_rate</code></pre>
</div>
<div id="exploratory-analysis" class="section level1">
<h1>Exploratory analysis</h1>
<pre class="r"><code># Exploratory 
analysis_df &lt;- read.csv(&quot;analysis_df.csv&quot;)

prop_per_continent &lt;- analysis_df |&gt;
  group_by(Continent)|&gt;
  summarize(&quot;Cumulative cases&quot;= sum(Total_cases), 
            &quot;Cumulative deaths&quot;= sum(Total_deaths),
            &quot;Cases per million&quot; = round(sum(Total_cases)/sum(Pop_millions)), 
            &quot;Deaths per million&quot; = round(sum(Total_deaths)/sum(Pop_millions)), 
            &quot;Population (in millions)&quot; = round(sum(Pop_millions)))

prop_per_continent &lt;- rbind(prop_per_continent, c(&quot;Total&quot;, colSums(prop_per_continent[,-1])))

prop_per_continent[,-1] &lt;- sapply( prop_per_continent[,-1], as.numeric )


knitr::kable(prop_per_continent, 
             caption =&quot;Table 1. Cumulative and per million number of Covid-19 cases and Deaths per continent&quot;,
             format.args = list(big.mark = &quot;,&quot;)) %&gt;%
  kable_styling(font_size = 15,
                bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;)) </code></pre>
<table class="table table-striped table-hover table-condensed" style="font-size: 15px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Table 1. Cumulative and per million number of Covid-19 cases and Deaths
per continent
</caption>
<thead>
<tr>
<th style="text-align:left;">
Continent
</th>
<th style="text-align:right;">
Cumulative cases
</th>
<th style="text-align:right;">
Cumulative deaths
</th>
<th style="text-align:right;">
Cases per million
</th>
<th style="text-align:right;">
Deaths per million
</th>
<th style="text-align:right;">
Population (in millions)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:right;">
12,015,548
</td>
<td style="text-align:right;">
254,447
</td>
<td style="text-align:right;">
8,993
</td>
<td style="text-align:right;">
190
</td>
<td style="text-align:right;">
1,336
</td>
</tr>
<tr>
<td style="text-align:left;">
Asia
</td>
<td style="text-align:right;">
153,635,027
</td>
<td style="text-align:right;">
1,419,170
</td>
<td style="text-align:right;">
34,198
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
4,492
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:right;">
205,726,976
</td>
<td style="text-align:right;">
1,845,405
</td>
<td style="text-align:right;">
276,147
</td>
<td style="text-align:right;">
2,477
</td>
<td style="text-align:right;">
745
</td>
</tr>
<tr>
<td style="text-align:left;">
North America
</td>
<td style="text-align:right;">
104,642,012
</td>
<td style="text-align:right;">
1,461,598
</td>
<td style="text-align:right;">
179,295
</td>
<td style="text-align:right;">
2,504
</td>
<td style="text-align:right;">
584
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania
</td>
<td style="text-align:right;">
8,656,552
</td>
<td style="text-align:right;">
11,105
</td>
<td style="text-align:right;">
217,939
</td>
<td style="text-align:right;">
280
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:left;">
South America
</td>
<td style="text-align:right;">
60,454,701
</td>
<td style="text-align:right;">
1,305,916
</td>
<td style="text-align:right;">
140,835
</td>
<td style="text-align:right;">
3,042
</td>
<td style="text-align:right;">
429
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
545,130,816
</td>
<td style="text-align:right;">
6,297,641
</td>
<td style="text-align:right;">
857,407
</td>
<td style="text-align:right;">
8,809
</td>
<td style="text-align:right;">
7,626
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ggplot(prop_per_continent[-1,], aes(x=Continent, y=`Deaths per million`, fill=Continent))+
  geom_bar(width = 1, stat = &quot;identity&quot;)+ 
  scale_fill_manual(values =c(wes_palette(&quot;Moonrise3&quot;)[-c(3,4)],wes_palette(&quot;Cavalcanti1&quot;)[c(2,4,5)]))+
  theme_classic()+
  ylab(&quot;Mortality rate (deaths per million)&quot;)+
  ggtitle(&quot;Mortality rate per continent&quot;)</code></pre>
<p><img src="Appendix_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="results-data-analysis" class="section level1">
<h1>RESULTS: Data Analysis</h1>
<pre class="r"><code>analysis_df &lt;- read.csv(&quot;analysis_df.csv&quot;)

# Run the analysis: linear regression
mod &lt;- lm(Total_deaths ~ Total_cases+ fully_vax_count+ Pop_millions+Percent_Over_65 + km2+ GDP_per_capita + Obesity_rate  + cvd_death_rate, analysis_df)
# check assumptions through diagnostic plots 
par(mfrow=c(2,2)) 
plot(mod)</code></pre>
<p><img src="Appendix_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code># check results 
mod_results &lt;- as_tibble(summary(mod)$coef) |&gt;
  mutate(Estimate=round(Estimate,3))|&gt;
  rename(&quot;P-value&quot;=`Pr(&gt;|t|)`)|&gt;
  select(-`t value`) |&gt;
  mutate(Variable= c(&quot;Intercept&quot;,&quot;Number of cases&quot;, &quot;Number fully vaccinated&quot;, &quot;Population (millions)&quot;, &quot;Percentage over65&quot; , &quot;Population density (km2)&quot;,&quot;GDP per capita&quot; , &quot;Obesity rate (%)&quot; ,&quot;CVD death rate&quot;), .before=Estimate)


knitr::kable(mod_results, 
             caption =&quot;Table 2. Exponentiated Linear regression coefficients with p-values&quot;,
             format.args = list(big.mark = &quot;,&quot;)) %&gt;%
  kable_styling(font_size = 15,
                bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;)) </code></pre>
<table class="table table-striped table-hover table-condensed" style="font-size: 15px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Table 2. Exponentiated Linear regression coefficients with p-values
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
-8,170.417
</td>
<td style="text-align:right;">
1.507129e+04
</td>
<td style="text-align:right;">
0.5885930
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of cases
</td>
<td style="text-align:right;">
0.011
</td>
<td style="text-align:right;">
5.313000e-04
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Number fully vaccinated
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1.932000e-04
</td>
<td style="text-align:right;">
0.1947506
</td>
</tr>
<tr>
<td style="text-align:left;">
Population (millions)
</td>
<td style="text-align:right;">
247.896
</td>
<td style="text-align:right;">
1.589986e+02
</td>
<td style="text-align:right;">
0.1212129
</td>
</tr>
<tr>
<td style="text-align:left;">
Percentage over65
</td>
<td style="text-align:right;">
-689.084
</td>
<td style="text-align:right;">
7.905291e+02
</td>
<td style="text-align:right;">
0.3848681
</td>
</tr>
<tr>
<td style="text-align:left;">
Population density (km2)
</td>
<td style="text-align:right;">
2.959
</td>
<td style="text-align:right;">
6.611918e+00
</td>
<td style="text-align:right;">
0.6551935
</td>
</tr>
<tr>
<td style="text-align:left;">
GDP per capita
</td>
<td style="text-align:right;">
-0.881
</td>
<td style="text-align:right;">
2.873695e-01
</td>
<td style="text-align:right;">
0.0025980
</td>
</tr>
<tr>
<td style="text-align:left;">
Obesity rate (%)
</td>
<td style="text-align:right;">
1,666.766
</td>
<td style="text-align:right;">
5.099264e+02
</td>
<td style="text-align:right;">
0.0013577
</td>
</tr>
<tr>
<td style="text-align:left;">
CVD death rate
</td>
<td style="text-align:right;">
-18.778
</td>
<td style="text-align:right;">
3.424035e+01
</td>
<td style="text-align:right;">
0.5842628
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># plot predicted vs observed values to determine the fit of the model
df_true_pred &lt;- data.frame(true= analysis_df$Total_deaths, predict=round((predict(mod, analysis_df))))

df_true_pred |&gt;
ggplot(aes(x=true, y=predict))+
  geom_point()+
  theme_classic()+
  geom_abline(intercept = 0, slope = 1, colour = &quot;red&quot;)+
  ylab(&quot;Predicted Cumulative death counts&quot;)+
  xlab(&quot;True Cumulative death counts&quot;) +
  ggtitle(&quot;Figure 3. Predicted vs true values for the outcome&quot;)</code></pre>
<p><img src="Appendix_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<pre class="r"><code># predictions with linear regression 
set.seed(1)
rmse_linear &lt;-replicate(1000, {
    y &lt;- analysis_df$Total_deaths
    test_index &lt;- createDataPartition(y, times = 1, p = 0.5, list = FALSE) 
    train_set &lt;- analysis_df |&gt; slice(-test_index) 
    test_set &lt;- analysis_df |&gt; slice(test_index) 
    fit &lt;- lm(Total_deaths ~ Total_cases+ fully_vax_count+ Pop_millions+ Percent_Over_65 + km2+ GDP_per_capita + Obesity_rate + cvd_death_rate, data = train_set) 
    y_hat &lt;- predict(fit, test_set)
    sqrt(mean((y_hat - test_set$Total_deaths)^2, na.rm = T)) 
})


hist(rmse_linear, main=&quot;Figure 4. Histogram of the RMSE across 1000 simulation \nusing a linear regression&quot;) 
mean(rmse_linear)</code></pre>
<p>[1] 98687.4</p>
<pre class="r"><code>sd(rmse_linear)</code></pre>
<p>[1] 63021.96</p>
<pre class="r"><code>mean(analysis_df$Total_deaths)</code></pre>
<p>[1] 40893.77</p>
<pre class="r"><code># predictions with knn machine learning 
set.seed(1)
rmse_knn &lt;-replicate(1000, {
    y &lt;- analysis_df$Total_deaths
    indexes = createDataPartition(analysis_df$Total_deaths, times = 1, p = 0.5, list = F)
    train = analysis_df[indexes, ] |&gt; select(-c(Country, Total_deaths, Continent))
    test = analysis_df[-indexes, ] |&gt; select(-c(Country, Total_deaths, Continent))
    test_outcome &lt;- analysis_df[-indexes, ]|&gt; pull(Total_deaths)
    train_outcome &lt;- analysis_df[indexes, ]  |&gt; pull(Total_deaths)
    reg_results &lt;- knn.reg(train[complete.cases(train), ], test[complete.cases(test), ], train_outcome, k = 3)
    sqrt(mean((reg_results$pred - test_outcome[complete.cases(test) ])^2, na.rm = T)) 
})

hist(rmse_knn, main=&quot;Figure 5. Histogram of the RMSE across 1000 simulation \nusing kNN&quot;) 

mean(rmse_knn)</code></pre>
<p>[1] 101833.9</p>
<pre class="r"><code>sd(rmse_knn)</code></pre>
<p>[1] 32260.5
<img src="Appendix_files/figure-html/unnamed-chunk-12-3.png" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
